<h1>Authors</h1>

<div id="search">
  <% form_tag( authors_path, :method => :get ) do -%>
    <%= text_field_tag( :s, params[:s] ) %> &nbsp; <%= check_box_tag( :a, '1', params[:a] == '1' ) %> Agencies? &nbsp; &nbsp; <%= submit_tag 'Search' %>
  <% end -%>
</div>
<br/>
<table>
  <tr>
    <th>Name</th>
    <th>Agency</th>
    <th>Story Count</th>
    <th>Alias Count</th>
    <th>Aliases</th>
  </tr>
<% @authors.each do |author| %>
  <tr>
    <td><%= author.name %></td>
    <td><%= author.is_agency? ? 'YES' : 'NO' %></td>
    <td><%= @story_counts[ author.id ] || 0 %></td>
    <td><%= author.aliases.size %></td>
    <td><%= author.aliases.collect{ |x| x.name }.join('<br/>') %></td>
    <td><%= link_to 'Edit', edit_author_path( author ) %></td>
    <td><%= link_to 'Merge', merge_author_path( author ) %></td>
  </tr>
<% end %>
</table>

<br />
<%= will_paginate @authors %>
<br />